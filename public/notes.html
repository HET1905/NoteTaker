<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
        integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">

    <link href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet"
        integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">

    <!-- <base href="/"> -->
    <link rel="stylesheet" type="text/css" href="./css/style.css">
    <title>Note Taker | Notes</title>
</head>

<body>
    <div class="container-fluid" id="notesPageContainer">
        <header>
            <div class="row">
                <div class="col-12 col-sm-8">
                    <h1>NoteTaker</h1>
                </div>
                <div class="col-12 col-sm-4">
                    <div class="icons text-right">
                        <i class="fa fa-save saveBtn"></i>
                        <i class="fa fa-pencil newBtn"></i>
                    </div>
                </div>
            </div>


        </header>
        <section id="dataSection">
            <div class="row">
                <div class="col-12 col-sm-5" id='leftDiv'>

                </div>
                <div class="col-12 col-sm-7" id='rightDiv'>
                    <input type="text" placeholder='Note Title' class="noteTitle" />
                    <textarea placeholder='Your notes' class="notesArea"></textarea>
                </div>
            </div>

        </section>

    </div>

    <script src="https://code.jquery.com/jquery-3.4.1.min.js"
        integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>

    <script>
        // $('#btnGetStarted').on('click', function () {
        //     alert('on click');
        // })
        function loadData() {
            $.get('/api/notes', function (data) {
                console.log(data);
                for (let i = 0; i < data.length; i++) {


                    let noteDiv = $('<div>');
                    let noteTitle = $('<h4>');
                    noteTitle.attr('id', 'note' + i);
                    noteDiv.attr('class', 'notesDiv');
                    noteTitle.attr('class', 'notesTitle');
                    noteTitle.attr('href', data[i].body);
                    noteTitle.text(data[i].title);
                    noteTitle.on('click',
                        function () {
                            $('.noteTitle').val(data[i].title);
                            $('.notesArea').text(data[i].body);
                            $('.noteTitle').prop('readonly', true);
                            $('.notesArea').prop('readonly', true);
                            // alert( + "  : " + );
                        });

                    $('.saveBtn').hide();
                    noteDiv.append(noteTitle);
                    $('#leftDiv').append(noteDiv);
                }

            })
        }

        $('.newBtn').on('click', function () {
            $('.saveBtn').show();
            $('.noteTitle').prop('readonly', false);
            $('.notesArea').prop('readonly', false);
            $('.noteTitle').text();
            $('.notesArea').text();
        });

        $('.saveBtn').on('click', function () {
           
            $('.noteTitle').prop('readonly', true);
            $('.notesArea').prop('readonly', true);
           
            var newNote = {
                title: $('.noteTitle').val().trim(),
                body: $('.notesArea').val().trim()
            };
           
            console.log(newNote);

            $.post('/api/notes', newNote, (data) => {
                if (data == true) {
                    alert("Notes added to table");
                }
            });

           
        });

        loadData();
    </script>

</body>

</html>